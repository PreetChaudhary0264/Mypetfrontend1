{"ast":null,"code":"import _objectSpread from\"C:/Users/ASUS/OneDrive/Desktop/FindMyPet/mypet-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import'./PetForm.css';import{toast,ToastContainer}from'react-toastify';import'react-toastify/dist/ReactToastify.css';//for my-pets\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const user=JSON.parse(localStorage.getItem(\"user\"));// or get from context\nconst PetForm=()=>{const[pet,setPet]=useState({name:'',breed:'',age:'',bio:'',photo:null,photoPreview:''});const[error,setError]=useState('');const navigate=useNavigate();const handleChange=e=>{const{name,value}=e.target;setPet(_objectSpread(_objectSpread({},pet),{},{[name]:value}));};const handlePhotoChange=e=>{const file=e.target.files[0];if(file){const reader=new FileReader();reader.onloadend=()=>{setPet(_objectSpread(_objectSpread({},pet),{},{photo:file,photoPreview:reader.result}));};reader.readAsDataURL(file);}};const handleSubmit=async e=>{e.preventDefault();setError('');const formData=new FormData();formData.append('name',pet.name);formData.append('breed',pet.breed);formData.append('age',pet.age);formData.append('bio',pet.bio);formData.append('profilephoto',pet.photo);formData.append(\"owner\",user._id);// ðŸ‘ˆ Send owner's ID\ntry{const res=await axios.post(\"http://localhost:4000/api/v1/register\",formData,{withCredentials:true,headers:{\"Content-Type\":\"multipart/form-data\"}});if(res.data.success){const registeredPet=res.data.pet;const qrUrl=\"http://localhost:3000/petdetails/\".concat(registeredPet._id);const reader=new FileReader();reader.onloadend=()=>{const petData=_objectSpread(_objectSpread({},registeredPet),{},{photoPreview:reader.result});toast.success(\"Pet registered! Redirecting to QR generation...\",{position:\"top-center\",autoClose:2000});setTimeout(()=>{navigate('/generate-qr',{state:{pet:petData,qrUrl}});},2000);};if(pet.photo){reader.readAsDataURL(pet.photo);}// Reset form\nsetPet({name:'',breed:'',age:'',bio:'',photo:null,photoPreview:''});}else{setError('Registration failed. Please try again.');}}catch(err){var _err$response,_err$response2,_err$response2$data;console.error(\"Axios Error:\",((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Something went wrong.');}};// const goToQR = () => {\n//  navigate('/generate-qr', { state: { pet: res.data.pet } },2000);\n// };\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"pet-form-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create Pet Profile\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-msg\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group photo-upload\",children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Profile Photo*\",/*#__PURE__*/_jsx(\"div\",{className:\"photo-preview\",children:pet.photoPreview?/*#__PURE__*/_jsx(\"img\",{src:pet.photoPreview,alt:\"Pet preview\"}):/*#__PURE__*/_jsx(\"div\",{className:\"photo-placeholder\",children:\"No photo selected\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handlePhotoChange,required:true})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Pet Name*\"}),/*#__PURE__*/_jsx(\"input\",{name:\"name\",value:pet.name,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Breed*\"}),/*#__PURE__*/_jsx(\"input\",{name:\"breed\",value:pet.breed,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Age*\"}),/*#__PURE__*/_jsx(\"input\",{name:\"age\",type:\"number\",value:pet.age,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Short Bio\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"bio\",value:pet.bio,onChange:handleChange,rows:\"3\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-btn\",children:\"Register Pet\"})]}),/*#__PURE__*/_jsx(ToastContainer,{})]});};export default PetForm;","map":{"version":3,"names":["React","useState","axios","useNavigate","toast","ToastContainer","jsx","_jsx","jsxs","_jsxs","user","JSON","parse","localStorage","getItem","PetForm","pet","setPet","name","breed","age","bio","photo","photoPreview","error","setError","navigate","handleChange","e","value","target","_objectSpread","handlePhotoChange","file","files","reader","FileReader","onloadend","result","readAsDataURL","handleSubmit","preventDefault","formData","FormData","append","_id","res","post","withCredentials","headers","data","success","registeredPet","qrUrl","concat","petData","position","autoClose","setTimeout","state","err","_err$response","_err$response2","_err$response2$data","console","response","message","className","children","onSubmit","src","alt","type","accept","onChange","required","rows"],"sources":["C:/Users/ASUS/OneDrive/Desktop/FindMyPet/mypet-frontend/src/components/PetRegistration/PetForm.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './PetForm.css';\r\nimport { toast, ToastContainer } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\n//for my-pets\r\nconst user = JSON.parse(localStorage.getItem(\"user\")); // or get from context\r\n\r\n\r\nconst PetForm = () => {\r\n  const [pet, setPet] = useState({\r\n    name: '',\r\n    breed: '',\r\n    age: '',\r\n    bio: '',\r\n    photo: null,\r\n    photoPreview: ''\r\n  });\r\n\r\n  const [error, setError] = useState('');\r\n  const navigate = useNavigate();\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setPet({ ...pet, [name]: value });\r\n  };\r\n\r\n  const handlePhotoChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        setPet({\r\n          ...pet,\r\n          photo: file,\r\n          photoPreview: reader.result\r\n        });\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError('');\r\n    const formData = new FormData();\r\n    formData.append('name', pet.name);\r\n    formData.append('breed', pet.breed);\r\n    formData.append('age', pet.age);\r\n    formData.append('bio', pet.bio);\r\n    formData.append('profilephoto', pet.photo);\r\n    formData.append(\"owner\", user._id); // ðŸ‘ˆ Send owner's ID\r\n\r\n\r\n    try {\r\n      const res = await axios.post(\"http://localhost:4000/api/v1/register\", formData, {\r\n        withCredentials: true,\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      });\r\n\r\n      if (res.data.success) {\r\n        const registeredPet = res.data.pet;\r\n        const qrUrl = `http://localhost:3000/petdetails/${registeredPet._id}`;\r\n\r\n        const reader = new FileReader();\r\n        reader.onloadend = () => {\r\n          const petData = {\r\n            ...registeredPet,\r\n            photoPreview: reader.result\r\n          };\r\n\r\n          toast.success(\"Pet registered! Redirecting to QR generation...\", {\r\n            position: \"top-center\",\r\n            autoClose: 2000\r\n          });\r\n\r\n          setTimeout(() => {\r\n            navigate('/generate-qr', {\r\n              state: {\r\n                pet: petData,\r\n                qrUrl\r\n              }\r\n            });\r\n          }, 2000);\r\n        };\r\n\r\n        if (pet.photo) {\r\n          reader.readAsDataURL(pet.photo);\r\n        }\r\n\r\n        // Reset form\r\n        setPet({\r\n          name: '',\r\n          breed: '',\r\n          age: '',\r\n          bio: '',\r\n          photo: null,\r\n          photoPreview: ''\r\n        });\r\n      } else {\r\n        setError('Registration failed. Please try again.');\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Axios Error:\", err.response?.data || err.message);\r\n      setError(err.response?.data?.message || 'Something went wrong.');\r\n    }\r\n  };\r\n\r\n  // const goToQR = () => {\r\n  //  navigate('/generate-qr', { state: { pet: res.data.pet } },2000);\r\n\r\n  // };\r\n\r\n  return (\r\n    <div className=\"pet-form-container\">\r\n      <h2>Create Pet Profile</h2>\r\n      {error && <p className=\"error-msg\">{error}</p>}\r\n\r\n      <form onSubmit={handleSubmit}>\r\n        {/* Photo */}\r\n        <div className=\"form-group photo-upload\">\r\n          <label>\r\n            Profile Photo*\r\n            <div className=\"photo-preview\">\r\n              {pet.photoPreview ? (\r\n                <img src={pet.photoPreview} alt=\"Pet preview\" />\r\n              ) : (\r\n                <div className=\"photo-placeholder\">No photo selected</div>\r\n              )}\r\n            </div>\r\n            <input\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              onChange={handlePhotoChange}\r\n              required\r\n            />\r\n          </label>\r\n        </div>\r\n\r\n        {/* Name, Breed, Age, Bio */}\r\n        <div className=\"form-group\">\r\n          <label>Pet Name*</label>\r\n          <input name=\"name\" value={pet.name} onChange={handleChange} required />\r\n        </div>\r\n        <div className=\"form-group\">\r\n          <label>Breed*</label>\r\n          <input name=\"breed\" value={pet.breed} onChange={handleChange} required />\r\n        </div>\r\n        <div className=\"form-group\">\r\n          <label>Age*</label>\r\n          <input name=\"age\" type=\"number\" value={pet.age} onChange={handleChange} required />\r\n        </div>\r\n        <div className=\"form-group\">\r\n          <label>Short Bio</label>\r\n          <textarea name=\"bio\" value={pet.bio} onChange={handleChange} rows=\"3\" />\r\n        </div>\r\n\r\n        <button type=\"submit\" className=\"submit-btn\">\r\n          Register Pet\r\n        </button>\r\n      </form>\r\n\r\n  <ToastContainer />\r\n    </div>\r\n    \r\n\r\n  );\r\n};\r\n\r\nexport default PetForm;\r\n"],"mappings":"4IAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,eAAe,CACtB,OAASC,KAAK,CAAEC,cAAc,KAAQ,gBAAgB,CACtD,MAAO,uCAAuC,CAE9C;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBACA,KAAM,CAAAC,IAAI,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAE;AAGvD,KAAM,CAAAC,OAAO,CAAGA,CAAA,GAAM,CACpB,KAAM,CAACC,GAAG,CAAEC,MAAM,CAAC,CAAGhB,QAAQ,CAAC,CAC7BiB,IAAI,CAAE,EAAE,CACRC,KAAK,CAAE,EAAE,CACTC,GAAG,CAAE,EAAE,CACPC,GAAG,CAAE,EAAE,CACPC,KAAK,CAAE,IAAI,CACXC,YAAY,CAAE,EAChB,CAAC,CAAC,CAEF,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGxB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAAAyB,QAAQ,CAAGvB,WAAW,CAAC,CAAC,CAE9B,KAAM,CAAAwB,YAAY,CAAIC,CAAC,EAAK,CAC1B,KAAM,CAAEV,IAAI,CAAEW,KAAM,CAAC,CAAGD,CAAC,CAACE,MAAM,CAChCb,MAAM,CAAAc,aAAA,CAAAA,aAAA,IAAMf,GAAG,MAAE,CAACE,IAAI,EAAGW,KAAK,EAAE,CAAC,CACnC,CAAC,CAED,KAAM,CAAAG,iBAAiB,CAAIJ,CAAC,EAAK,CAC/B,KAAM,CAAAK,IAAI,CAAGL,CAAC,CAACE,MAAM,CAACI,KAAK,CAAC,CAAC,CAAC,CAC9B,GAAID,IAAI,CAAE,CACR,KAAM,CAAAE,MAAM,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAC/BD,MAAM,CAACE,SAAS,CAAG,IAAM,CACvBpB,MAAM,CAAAc,aAAA,CAAAA,aAAA,IACDf,GAAG,MACNM,KAAK,CAAEW,IAAI,CACXV,YAAY,CAAEY,MAAM,CAACG,MAAM,EAC5B,CAAC,CACJ,CAAC,CACDH,MAAM,CAACI,aAAa,CAACN,IAAI,CAAC,CAC5B,CACF,CAAC,CAED,KAAM,CAAAO,YAAY,CAAG,KAAO,CAAAZ,CAAC,EAAK,CAChCA,CAAC,CAACa,cAAc,CAAC,CAAC,CAClBhB,QAAQ,CAAC,EAAE,CAAC,CACZ,KAAM,CAAAiB,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAE5B,GAAG,CAACE,IAAI,CAAC,CACjCwB,QAAQ,CAACE,MAAM,CAAC,OAAO,CAAE5B,GAAG,CAACG,KAAK,CAAC,CACnCuB,QAAQ,CAACE,MAAM,CAAC,KAAK,CAAE5B,GAAG,CAACI,GAAG,CAAC,CAC/BsB,QAAQ,CAACE,MAAM,CAAC,KAAK,CAAE5B,GAAG,CAACK,GAAG,CAAC,CAC/BqB,QAAQ,CAACE,MAAM,CAAC,cAAc,CAAE5B,GAAG,CAACM,KAAK,CAAC,CAC1CoB,QAAQ,CAACE,MAAM,CAAC,OAAO,CAAElC,IAAI,CAACmC,GAAG,CAAC,CAAE;AAGpC,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAA5C,KAAK,CAAC6C,IAAI,CAAC,uCAAuC,CAAEL,QAAQ,CAAE,CAC9EM,eAAe,CAAE,IAAI,CACrBC,OAAO,CAAE,CACP,cAAc,CAAE,qBAClB,CACF,CAAC,CAAC,CAEF,GAAIH,GAAG,CAACI,IAAI,CAACC,OAAO,CAAE,CACpB,KAAM,CAAAC,aAAa,CAAGN,GAAG,CAACI,IAAI,CAAClC,GAAG,CAClC,KAAM,CAAAqC,KAAK,qCAAAC,MAAA,CAAuCF,aAAa,CAACP,GAAG,CAAE,CAErE,KAAM,CAAAV,MAAM,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAC/BD,MAAM,CAACE,SAAS,CAAG,IAAM,CACvB,KAAM,CAAAkB,OAAO,CAAAxB,aAAA,CAAAA,aAAA,IACRqB,aAAa,MAChB7B,YAAY,CAAEY,MAAM,CAACG,MAAM,EAC5B,CAEDlC,KAAK,CAAC+C,OAAO,CAAC,iDAAiD,CAAE,CAC/DK,QAAQ,CAAE,YAAY,CACtBC,SAAS,CAAE,IACb,CAAC,CAAC,CAEFC,UAAU,CAAC,IAAM,CACfhC,QAAQ,CAAC,cAAc,CAAE,CACvBiC,KAAK,CAAE,CACL3C,GAAG,CAAEuC,OAAO,CACZF,KACF,CACF,CAAC,CAAC,CACJ,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAED,GAAIrC,GAAG,CAACM,KAAK,CAAE,CACba,MAAM,CAACI,aAAa,CAACvB,GAAG,CAACM,KAAK,CAAC,CACjC,CAEA;AACAL,MAAM,CAAC,CACLC,IAAI,CAAE,EAAE,CACRC,KAAK,CAAE,EAAE,CACTC,GAAG,CAAE,EAAE,CACPC,GAAG,CAAE,EAAE,CACPC,KAAK,CAAE,IAAI,CACXC,YAAY,CAAE,EAChB,CAAC,CAAC,CACJ,CAAC,IAAM,CACLE,QAAQ,CAAC,wCAAwC,CAAC,CACpD,CACF,CAAE,MAAOmC,GAAG,CAAE,KAAAC,aAAA,CAAAC,cAAA,CAAAC,mBAAA,CACZC,OAAO,CAACxC,KAAK,CAAC,cAAc,CAAE,EAAAqC,aAAA,CAAAD,GAAG,CAACK,QAAQ,UAAAJ,aAAA,iBAAZA,aAAA,CAAcX,IAAI,GAAIU,GAAG,CAACM,OAAO,CAAC,CAChEzC,QAAQ,CAAC,EAAAqC,cAAA,CAAAF,GAAG,CAACK,QAAQ,UAAAH,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcZ,IAAI,UAAAa,mBAAA,iBAAlBA,mBAAA,CAAoBG,OAAO,GAAI,uBAAuB,CAAC,CAClE,CACF,CAAC,CAED;AACA;AAEA;AAEA,mBACEzD,KAAA,QAAK0D,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACjC7D,IAAA,OAAA6D,QAAA,CAAI,oBAAkB,CAAI,CAAC,CAC1B5C,KAAK,eAAIjB,IAAA,MAAG4D,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAE5C,KAAK,CAAI,CAAC,cAE9Cf,KAAA,SAAM4D,QAAQ,CAAE7B,YAAa,CAAA4B,QAAA,eAE3B7D,IAAA,QAAK4D,SAAS,CAAC,yBAAyB,CAAAC,QAAA,cACtC3D,KAAA,UAAA2D,QAAA,EAAO,gBAEL,cAAA7D,IAAA,QAAK4D,SAAS,CAAC,eAAe,CAAAC,QAAA,CAC3BpD,GAAG,CAACO,YAAY,cACfhB,IAAA,QAAK+D,GAAG,CAAEtD,GAAG,CAACO,YAAa,CAACgD,GAAG,CAAC,aAAa,CAAE,CAAC,cAEhDhE,IAAA,QAAK4D,SAAS,CAAC,mBAAmB,CAAAC,QAAA,CAAC,mBAAiB,CAAK,CAC1D,CACE,CAAC,cACN7D,IAAA,UACEiE,IAAI,CAAC,MAAM,CACXC,MAAM,CAAC,SAAS,CAChBC,QAAQ,CAAE1C,iBAAkB,CAC5B2C,QAAQ,MACT,CAAC,EACG,CAAC,CACL,CAAC,cAGNlE,KAAA,QAAK0D,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB7D,IAAA,UAAA6D,QAAA,CAAO,WAAS,CAAO,CAAC,cACxB7D,IAAA,UAAOW,IAAI,CAAC,MAAM,CAACW,KAAK,CAAEb,GAAG,CAACE,IAAK,CAACwD,QAAQ,CAAE/C,YAAa,CAACgD,QAAQ,MAAE,CAAC,EACpE,CAAC,cACNlE,KAAA,QAAK0D,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB7D,IAAA,UAAA6D,QAAA,CAAO,QAAM,CAAO,CAAC,cACrB7D,IAAA,UAAOW,IAAI,CAAC,OAAO,CAACW,KAAK,CAAEb,GAAG,CAACG,KAAM,CAACuD,QAAQ,CAAE/C,YAAa,CAACgD,QAAQ,MAAE,CAAC,EACtE,CAAC,cACNlE,KAAA,QAAK0D,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB7D,IAAA,UAAA6D,QAAA,CAAO,MAAI,CAAO,CAAC,cACnB7D,IAAA,UAAOW,IAAI,CAAC,KAAK,CAACsD,IAAI,CAAC,QAAQ,CAAC3C,KAAK,CAAEb,GAAG,CAACI,GAAI,CAACsD,QAAQ,CAAE/C,YAAa,CAACgD,QAAQ,MAAE,CAAC,EAChF,CAAC,cACNlE,KAAA,QAAK0D,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB7D,IAAA,UAAA6D,QAAA,CAAO,WAAS,CAAO,CAAC,cACxB7D,IAAA,aAAUW,IAAI,CAAC,KAAK,CAACW,KAAK,CAAEb,GAAG,CAACK,GAAI,CAACqD,QAAQ,CAAE/C,YAAa,CAACiD,IAAI,CAAC,GAAG,CAAE,CAAC,EACrE,CAAC,cAENrE,IAAA,WAAQiE,IAAI,CAAC,QAAQ,CAACL,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,cAE7C,CAAQ,CAAC,EACL,CAAC,cAEX7D,IAAA,CAACF,cAAc,GAAE,CAAC,EACX,CAAC,CAIV,CAAC,CAED,cAAe,CAAAU,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}